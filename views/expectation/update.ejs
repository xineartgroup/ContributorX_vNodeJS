<%- include('../partials/header.ejs') %>
<body>
    <%- include('../partials/nav.ejs') %>

    <div class="detail-ui content">
        <h2>Update Expectation</h2>
        <form action="/expectation/update/<%= expectation._id %>" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label for="Contributor">Contributor:</label>
                <select id="Contributor" name="Contributor" required>
                    <% contributors.forEach(contributor => { %>
                        <option value="<%= contributor._id %>" <%= expectation.Contributor._id.toString() === contributor._id.toString() ? 'selected' : '' %>><%= contributor.UserName %></option>
                    <% }) %>
                </select>
            </div>

            <div class="form-group">
                <label for="Contribution">Contribution:</label>
                <select id="Contribution" name="Contribution" required>
                    <% contributions.forEach(contribution => { %>
                        <option value="<%= contribution._id %>" <%= expectation.Contribution._id.toString() === contribution._id.toString() ? 'selected' : '' %>><%= contribution.Name %></option>
                    <% }) %>
                </select>
            </div>

            <div class="form-group">
                <label for="AmountPaid">Amount Paid:</label>
                <input type="number" id="AmountPaid" name="AmountPaid" value="<%= expectation.AmountPaid %>" step="0.01" required>
            </div>

            <div class="form-group">
                <label for="AmountToApprove">Amount To Approve:</label>
                <input type="number" id="AmountToApprove" name="AmountToApprove" value="<%= expectation.AmountToApprove %>" step="0.01" required>
            </div>

            <div class="form-group">
                <label for="PaymentStatus">Payment Status:</label>
                <select id="PaymentStatus" name="PaymentStatus" required>
                    <option value="0" <%= expectation.PaymentStatus === 0 ? 'selected' : '' %>>Pending</option>
                    <option value="1" <%= expectation.PaymentStatus === 1 ? 'selected' : '' %>>Processing</option>
                    <option value="2" <%= expectation.PaymentStatus === 2 ? 'selected' : '' %>>Cleared</option>
                </select>
            </div>

            <div class="form-group">
                <label for="PaymentReciept">Receipt (optional):</label>
                <input type="file" id="PaymentReciept" name="PaymentReciept">
                <% if (expectation.PaymentReciept) { %>
                    <p><a href="<%= expectation.PaymentReciept %>" target="_blank">View Current Receipt</a></p>
                <% } %>
            </div>

            <div class="form-buttons">
                <button type="submit">Update</button>
                <a href="/expectation" class="cancel-button">Cancel</a>
            </div>
        </form>
    </div>
</body>
<%- include('../partials/footer.ejs') %>
